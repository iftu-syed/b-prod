<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        .profile-card {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
        }
        .profile-body {
            flex: 1 1 100%;
            margin-bottom: 20px;
        }
        .survey-buttons {
            flex: 1 1 100%;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .survey-button {
            flex: 1 1 calc(50% - 10px);
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .button-container {
            flex: 1 1 100%;
        }
        .note-form,
        .code-form {
            flex: 1 1 100%;
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 10px;
        }
        .note-form label,
        .code-form label {
            width: auto;
            margin-right: 10px;
        }
        .note-form input[type="text"],
        .note-form input[type="date"],
        .note-form button,
        .code-form select,
        .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            flex: none;
        }
        .note-form input[type="text"],
        .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button,
        .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover,
        .code-form button:hover {
            background-color: #0056b3;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }

        
    </style>
</head>
<body>
    <div class="profile-card">
        <div class="profile-body">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
            <form action="/execute" method="GET">
                <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                <button type="submit">View your patient health outcomes report</button>
            </form>
        </div>
        <div class="survey-buttons">
            <% if (surveyNames.length > 0) { %>
                <% surveyNames.forEach(function(name) { %>
                    <form action="/generateGraph" method="POST" style="margin-bottom: 10px;">
                        <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                        <input type="hidden" name="surveyType" value="<%= name === 'Assessment of urinary incontinence in pregnancy (ICIQ-UI SF)' ? 'ICIQ-UI_SF' : name %>">
                        <button type="submit" class="survey-button">
                            <%= name %>
                        </button>
                    </form>
                <% }); %>
            <% } else { %>
                <p><strong>No surveys available for this patient.</strong></p>
            <% } %>
        </div>
        <div class="note-form">
            <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                <label for="note">Date of Intervention:</label>
                <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                <label for="date">Date:</label>
                <input type="date" id="date" name="date" required>
                <button type="submit">Save !</button>
                <span class="success-message" id="note-message">Successfully added!</span>
            </form>
        </div>
        <div class="code-form">
            <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                <label for="code">Code:</label>
                <select id="code" name="code" required>
                    <option value="" disabled selected>Select a code</option>
                    <% codes.forEach(function(code) { %>
                        <option value="<%= code.code %>"><%= code.description %></option>
                    <% }); %>
                </select>
                <input type="hidden" id="code_date" name="code_date">
                <button type="submit">Save !</button>
                <span class="success-message" id="code-message">Successfully added!</span>
            </form>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Initialize Select2 for the code dropdown
            $('#code').select2();

            // Set the current date in the hidden date input field
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault(); // Prevent the form from submitting the default way
            const form = document.getElementById(formId);
            const formData = $(form).serialize(); // Serialize the form data

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }
    </script>
</body>
</html> -->


<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        /* Other existing CSS */
        
        .profile-card {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            max-width: 900px;
            margin: 0 auto;
            padding: 5px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
        }
        .profile-body {
            flex: 1 1 100%;
            margin-bottom: 20px;
        }
        .survey-buttons {
            flex: 1 1 100%;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .survey-button {
            flex: 1 1 calc(50% - 10px);
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .button-container {
            flex: 1 1 100%;
        }
        .note-form,
        .code-form {
            flex: 1 1 100%;
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 10px;
        }
        .note-form label,
        .code-form label {
            width: auto;
            margin-right: 10px;
        }
        .note-form input[type="text"],
        .note-form input[type="date"],
        .note-form button,
        .code-form select,
        .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            flex: none;
        }
        .note-form input[type="text"],
        .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button,
        .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover,
        .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px; /* Adjusted width */
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
    </style>
    
</head>
<body>
    <div class="profile-card">
        <div class="profile-body">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
            <form action="/execute" method="GET">
                <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                <button type="submit">View your patient health outcomes report</button>
            </form>
        </div>
        <div class="survey-buttons">
            <% if (surveyNames.length > 0) { %>
                <% surveyNames.forEach(function(name) { %>
                    <form action="/generateGraph" method="POST" style="margin-bottom: 10px;">
                        <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                        <input type="hidden" name="surveyType" value="<%= name === 'Assessment of urinary incontinence in pregnancy (ICIQ-UI SF)' ? 'ICIQ-UI_SF' : name %>">
                        <button type="submit" class="survey-button">
                            <%= name %>
                        </button>
                    </form>
                <% }); %>
            <% } else { %>
                <p><strong>No surveys available for this patient.</strong></p>
            <% } %>
        </div>
        <div class="note-form">
            <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                <label for="note">Date of Intervention:</label>
                <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                <label for="date">Date:</label>
                <input type="date" id="date" name="date" required>
                <button type="submit">Save !</button>
                <span class="success-message" id="note-message">Successfully added!</span>
            </form>
        </div>
        <div class="code-form">
            <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                <label for="code">Code:</label>
                <select id="code" name="code" required>
                    <option value="" disabled selected>Select a code</option>
                    <% codes.forEach(function(code) { %>
                        <option value="<%= code.code %>"><%= code.description %></option>
                    <% }); %>
                </select>
                <input type="hidden" id="code_date" name="code_date">
                <button type="submit">Save !</button>
                <span class="success-message" id="code-message">Successfully added!</span>
            </form>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Initialize Select2 for the code dropdown
            $('#code').select2();

            // Set the current date in the hidden date input field
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault(); // Prevent the form from submitting the default way
            const form = document.getElementById(formId);
            const formData = $(form).serialize(); // Serialize the form data

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }
    </script>
</body>
</html> -->

<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        /* Existing CSS for the profile-card */
        .profile-card {
            max-width: 300px;
            margin: 20px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .highlight {
            font-weight: bold;
            color: #007bff;
        }

        /* New CSS for the form-container */
        .form-container {
            max-width: 900px;
            margin: 20px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .survey-buttons,
        .note-form,
        .code-form {
            margin-bottom: 20px;
        }

        .survey-button {
            margin: 5px;
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }

        .survey-button:hover {
            background-color: #218838;
        }

        .note-form label,
        .code-form label {
            width: auto;
            margin-right: 10px;
        }

        .note-form input[type="text"],
        .note-form input[type="date"],
        .note-form button,
        .code-form select,
        .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .note-form button,
        .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }

        .note-form button:hover,
        .code-form button:hover {
            background-color: #0056b3;
        }

        .code-form select {
            width: 400px;
        }

        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }

        .notes-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .notes-table th, .notes-table td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: left;
        }

        .notes-table th {
            background-color: #007bff;
            color: white;
        }
    </style>
</head>
<body>
    <div class="profile-card">
        <div class="profile-body">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
    </div>

    <div class="form-container">
        <div class="survey-buttons">
            <% if (surveyNames.length > 0) { %>
                <% surveyNames.forEach(function(name) { %>
                    <form action="/generateGraph" method="POST" style="display: inline;">
                        <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                        <input type="hidden" name="surveyType" value="<%= name === 'Assessment of urinary incontinence in pregnancy (ICIQ-UI SF)' ? 'ICIQ-UI_SF' : name %>">
                        <button type="submit" class="survey-button">
                            <%= name %>
                        </button>
                    </form>
                <% }); %>
            <% } else { %>
                <p><strong>No surveys available for this patient.</strong></p>
            <% } %>
        </div>

        <div class="note-form">
            <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                <label for="note">Date of Intervention:</label>
                <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                <label for="date">Date:</label>
                <input type="date" id="date" name="date" required>
                <button type="submit">Add</button>
                <span class="success-message" id="note-message">Successfully added!</span>
            </form>
        </div>

        <div class="code-form">
            <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                <label for="code">Code:</label>
                <select id="code" name="code" required>
                    <option value="" disabled selected>Select a code</option>
                    <% codes.forEach(function(code) { %>
                        <option value="<%= code.code %>"><%= code.description %></option>
                    <% }); %>
                </select>
                <input type="hidden" id="code_date" name="code_date">
                <button type="submit">Add</button>
                <span class="success-message" id="code-message">Successfully added!</span>
            </form>
        </div>

        <div class="note-form">
            <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                <label for="doctor-note">Doctor's Note:</label>
                <input type="text" id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required>
                <button type="submit">Add</button>
                <span class="success-message" id="note-doctor">Successfully added!</span>
            </form>
        </div>

        <div class="doctor-notes">
            <h3>Doctor's Notes</h3>
            <table id="doctor-notes-table" class="notes-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Note</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (doctorNotes.length > 0) { %>
                        <% doctorNotes.forEach(function(note) { %>
                            <tr>
                                <td><%= note.date %></td>
                                <td><%= note.note %></td>
                            </tr>
                        <% }); %>
                    <% } else { %>
                        <tr>
                            <td colspan="2">No notes available</td>
                        </tr>
                    <% } %>
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Initialize Select2 for the code dropdown
            $('#code').select2();

            // Set the current date in the hidden date input field
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault(); // Prevent the form from submitting the default way
            const form = document.getElementById(formId);
            const formData = $(form).serialize(); // Serialize the form data

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    // Update the table with the new doctor's note
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToTable(noteDate, noteText);
                        document.getElementById('doctor-note').value = ''; // Clear the input field
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToTable(date, note) {
            const table = document.getElementById('doctor-notes-table');
            const newRow = table.insertRow();
            const dateCell = newRow.insertCell(0);
            const noteCell = newRow.insertCell(1);
            dateCell.textContent = date;
            noteCell.textContent = note;
        }
    </script>
</body>
</html> -->

<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        .container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
        }
        .profile-card {
            max-width: 300px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .survey-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .survey-button {
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .note-form, .code-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 10px;
        }
        .note-form label, .code-form label {
            margin-right: 10px;
        }
        .note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .note-form input[type="text"], .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button, .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover, .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
        .notes-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .notes-table th, .notes-table td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: left;
        }
        .notes-table th {
            background-color: #007bff;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="form-container">
            <div class="survey-buttons">
                <% if (surveyNames.length > 0) { %>
                    <% surveyNames.forEach(function(name) { %>
                        <form action="/generateGraph" method="POST" style="margin-bottom: 10px;">
                            <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                            <input type="hidden" name="surveyType" value="<%= name === 'Assessment of urinary incontinence in pregnancy (ICIQ-UI SF)' ? 'ICIQ-UI_SF' : name %>">
                            <button type="submit" class="survey-button">
                                <%= name %>
                            </button>
                        </form>
                    <% }); %>
                <% } else { %>
                    <p><strong>No surveys available for this patient.</strong></p>
                <% } %>
            </div>
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Date of Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit">Save !</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit">Save !</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="note-form">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <input type="text" id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required>
                    <button type="submit">Save !</button>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            <div class="doctor-notes">
                <h3>Doctor's Notes</h3>
                <table id="doctor-notes-table" class="notes-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Note</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (doctorNotes.length > 0) { %>
                            <% doctorNotes.forEach(function(note) { %>
                                <tr>
                                    <td><%= note.date %></td>
                                    <td><%= note.note %></td>
                                </tr>
                            <% }); %>
                        <% } else { %>
                            <tr>
                                <td colspan="2">No notes available</td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            $('#code').select2();
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = $(form).serialize();
            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToTable(noteDate, noteText);
                        document.getElementById('doctor-note').value = '';
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToTable(date, note) {
            const table = document.getElementById('doctor-notes-table');
            const newRow = table.insertRow();
            const dateCell = newRow.insertCell(0);
            const noteCell = newRow.insertCell(1);
            dateCell.textContent = date;
            noteCell.textContent = note;
        }
    </script>
</body>
</html> -->

<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        .container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
        }
        .profile-card {
            max-width: 300px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .survey-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .survey-button {
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .note-form, .code-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 10px;
        }
        .note-form label, .code-form label {
            margin-right: 10px;
        }
        .note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .note-form input[type="text"], .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button, .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover, .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
        .notes-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .notes-table th, .notes-table td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: left;
        }
        .notes-table th {
            background-color: #007bff;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="form-container">
            <div class="survey-buttons">
                <% if (surveyNames.length > 0) { %>
                    <% surveyNames.forEach(function(name) { %>
                        <form action="/generateGraph" method="POST" style="margin-bottom: 10px;">
                            <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                            <input type="hidden" name="surveyType" value="<%= name === 'Assessment of urinary incontinence in pregnancy (ICIQ-UI SF)' ? 'ICIQ-UI_SF' : name %>">
                            <button type="submit" class="survey-button">
                                <%= name %>
                            </button>
                        </form>
                    <% }); %>
                <% } else { %>
                    <p><strong>No surveys available for this patient.</strong></p>
                <% } %>
            </div>
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Date of Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit">Save !</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit">Save !</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="note-form">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <input type="text" id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required>
                    <button type="submit">Save !</button>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            <div class="doctor-notes">
                <h3>Doctor's Notes</h3>
                <table id="doctor-notes-table" class="notes-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Note</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (doctorNotes.length > 0) { %>
                            <% doctorNotes.forEach(function(note) { %>
                                <tr>
                                    <td><%= note.date %></td>
                                    <td><%= note.note %></td>
                                </tr>
                            <% }); %>
                        <% } else { %>
                            <tr>
                                <td colspan="2">No notes available</td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            $('#code').select2();
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = $(form).serialize();

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToTable(noteDate, noteText);
                        document.getElementById('doctor-note').value = '';
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToTable(date, note) {
            const table = document.getElementById('doctor-notes-table');
            const newRow = table.insertRow();
            const dateCell = newRow.insertCell(0);
            const noteCell = newRow.insertCell(1);
            dateCell.textContent = date;
            noteCell.textContent = note;
        }
    </script>
</body>
</html> -->


<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        .container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
        }
        .profile-card {
            max-width: 300px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .survey-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .survey-button {
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .note-form, .code-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 10px;
        }
        .note-form label, .code-form label {
            margin-right: 10px;
        }
        .note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .note-form input[type="text"], .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button, .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover, .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
        .doctor-notes {
            max-height: 600px;
            overflow-y: auto;
            background-color: #f5f5f5;
            padding: 0px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .log-entry {
            margin-bottom: 10px;
            padding: 10px;
            background-color: #e9ecef;
            border-left: 5px solid #007bff;
        }
        .log-date {
            font-weight: bold;
            color: #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="form-container">
            <div class="survey-buttons">
                <% if (surveyNames.length > 0) { %>
                    <% surveyNames.forEach(function(name) { %>
                        <form action="/generateGraph" method="POST" style="margin-bottom: 10px;">
                            <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                            <input type="hidden" name="surveyType" value="<%= name === 'Assessment of urinary incontinence in pregnancy (ICIQ-UI SF)' ? 'ICIQ-UI_SF' : name %>">
                            <button type="submit" class="survey-button">
                                <%= name %>
                            </button>
                        </form>
                    <% }); %>
                <% } else { %>
                    <p><strong>No surveys available for this patient.</strong></p>
                <% } %>
            </div>
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit">Add</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit">Add</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="note-form">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <input type="text" id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required>
                    <button type="submit">Add</button>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            <div class="doctor-notes">
                <h3>Doctor's Notes</h3>
                <% if (doctorNotes.length > 0) { %>
                    <% doctorNotes.forEach(function(note) { %>
                        <div class="log-entry">
                            <div class="log-date"><%= note.date %></div>
                            <div class="log-note"><%= note.note %></div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p>No notes available</p>
                <% } %>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            $('#code').select2();
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = $(form).serialize();

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToLog(noteDate, noteText);
                        document.getElementById('doctor-note').value = '';
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToLog(date, note) {
            const logContainer = document.querySelector('.doctor-notes');
            const newLogEntry = document.createElement('div');
            newLogEntry.className = 'log-entry';
            newLogEntry.innerHTML = `
                <div class="log-date">${date}</div>
                <div class="log-note">${note}</div>
            `;
            logContainer.appendChild(newLogEntry);
        }
    </script>
</body>
</html> -->






<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        .container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
        }
        .profile-card {
            max-width: 300px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .survey-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .survey-button {
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .note-form, .code-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 20px;
        }
        .note-form label, .code-form label {
            margin-right: 10px;
        }
        .note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .note-form input[type="text"], .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button, .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover, .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
            .doctor-notes {
                max-height: 600px;
                overflow-y: auto;
                background-color: #f5f5f5;
                padding: 10px;
                border-radius: 4px;
                font-family: monospace;
                white-space: pre-wrap;
            }
        .log-entry {
            margin-bottom: 5px;
            padding: 5px 10px;
            background-color: #e9ecef;
            border-left: 5px solid #007bff;
        }
        .log-date {
            font-weight: bold;
            color: #007bff;
        }
        .log-note {
            margin: 5px 0;
        }

        .add-button{
            margin-left: 15px;
        }
        .add-button-extra{
            margin-left: 15px;
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="form-container">
            <div class="survey-buttons">
                <% if (surveyNames.length > 0) { %>
                    <% surveyNames.forEach(function(name) { %>
                        <form action="/generateGraph" method="POST" style="margin-bottom: 10px;">
                            <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                            <input type="hidden" name="surveyType" value="<%= name === 'Assessment of urinary incontinence in pregnancy (ICIQ-UI SF)' ? 'ICIQ-UI_SF' : name %>">
                            <button type="submit" class="survey-button">
                                <%= name %>
                            </button>
                        </form>
                    <% }); %>
                <% } else { %>
                    <p><strong>No surveys available for this patient.</strong></p>
                <% } %>
            </div>
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit">Add</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">ICD Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="note-form">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <textarea id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required></textarea>
                    <button type="submit" class="add-button-extra">Add</button>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            <div class="doctor-notes">
                <h3>Doctor's Notes</h3>
                <% if (doctorNotes.length > 0) { %>
                    <% doctorNotes.forEach(function(note) { %>
                        <div class="log-entry">
                            <div class="log-date"><%= note.date %></div>
                            <div class="log-note"><%= note.note %></div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p>No notes available</p>
                <% } %>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            $('#code').select2();
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = $(form).serialize();

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToLog(noteDate, noteText);
                        document.getElementById('doctor-note').value = '';
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToLog(date, note) {
            const logContainer = document.querySelector('.doctor-notes');
            const newLogEntry = document.createElement('div');
            newLogEntry.className = 'log-entry';
            newLogEntry.innerHTML = `
                <div class="log-date">${date}</div>
                <div class="log-note">${note}</div>
            `;
            logContainer.appendChild(newLogEntry);
        }
    </script>
</body>
</html> -->


<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        /* Add the CSS here */
        .container {
    display: flex;
    justify-content: flex-start;
    align-items: flex-start;
    gap: 20px;
    padding: 20px;
}
.profile-card {
    max-width: 300px;
    padding: 20px;
    background-color: #ffffff;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}
.form-container {
    flex-grow: 1;
    padding: 20px;
    background-color: #ffffff;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}
.survey-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
}
.survey-button {
    padding: 10px;
    background-color: #28a745;
    color: #ffffff;
    border: none;
    border-radius: 4px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
}
.survey-button:hover {
    background-color: #218838;
}
.highlight {
    font-weight: bold;
    color: #007bff;
}
.note-form, .code-form {
    display: flex;
    flex-direction: row;
    align-items: center;
    margin-bottom: 20px;
}
.note-form label, .code-form label {
    margin-right: 10px;
}
.note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
    padding: 10px;
    margin-right: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
}
.note-form input[type="text"], .code-form select {
    width: 200px;
}
.note-form input[type="date"] {
    width: 150px;
}
.note-form button, .code-form button {
    background-color: #007bff;
    color: #ffffff;
    border: none;
    border-radius: 4px;
    font-size: 16px;
    cursor: pointer;
}
.note-form button:hover, .code-form button:hover {
    background-color: #0056b3;
}
.code-form select {
    width: 400px;
}
.success-message {
    color: green;
    display: none;
    margin-left: 10px;
}
.doctor-notes {
    max-height: 600px;
    overflow-y: auto;
    background-color: #f5f5f5;
    padding: 10px;
    border-radius: 4px;
    font-family: monospace;
    white-space: pre-wrap;
}
.log-entry {
    margin-bottom: 5px;
    padding: 5px 10px;
    background-color: #e9ecef;
    border-left: 5px solid #007bff;
}
.log-date {
    font-weight: bold;
    color: #007bff;
}
.log-note {
    margin: 5px 0;
}
.textarea-container {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
}
textarea {
    font-family: monospace;
    font-size: 16px;
    color: fieldtext;
    resize: vertical;
    cursor: text;
    overflow-wrap: break-word;
    background-color: field;
    margin: 0em;
    border-width: 1px;
    border-style: solid;
    border-color: rgb(118, 118, 118);
    padding: 10px;
    white-space: pre-wrap;
    width: calc(100% - 70px); /* Adjust width to account for the button width */
    height: 60px; /* Adjust height as needed */
}
.textarea-container button {
    background-color: #007bff;
    color: #ffffff;
    border: none;
    border-radius: 4px;
    font-size: 16px;
    cursor: pointer;
    height: 60px; /* Match the height of the textarea */
    margin-left: 10px;
}
.textarea-container button:hover {
    background-color: #0056b3;
}

    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="form-container">
            <div class="survey-buttons">
                <% if (surveyNames.length > 0) { %>
                    <% surveyNames.forEach(function(name) { %>
                        <form action="/generateGraph" method="POST" style="margin-bottom: 10px;">
                            <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                            <input type="hidden" name="surveyType" value="<%= name === 'Assessment of urinary incontinence in pregnancy (ICIQ-UI SF)' ? 'ICIQ-UI_SF' : name %>">
                            <button type="submit" class="survey-button">
                                <%= name %>
                            </button>
                        </form>
                    <% }); %>
                <% } else { %>
                    <p><strong>No surveys available for this patient.</strong></p>
                <% } %>
            </div>
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit">Add</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">ICD Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="textarea-container">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <textarea id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required></textarea>
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            
            <div class="doctor-notes">
                <h3>Doctor's Notes</h3>
                <% if (doctorNotes.length > 0) { %>
                    <% doctorNotes.forEach(function(note) { %>
                        <div class="log-entry">
                            <div class="log-date"><%= note.date %></div>
                            <div class="log-note"><%= note.note %></div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p>No notes available</p>
                <% } %>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            $('#code').select2();
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = $(form).serialize();

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToLog(noteDate, noteText);
                        document.getElementById('doctor-note').value = '';
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToLog(date, note) {
            const logContainer = document.querySelector('.doctor-notes');
            const newLogEntry = document.createElement('div');
            newLogEntry.className = 'log-entry';
            newLogEntry.innerHTML = `
                <div class="log-date">${date}</div>
                <div class="log-note">${note}</div>
            `;
            logContainer.appendChild(newLogEntry);
        }
    </script>
</body>
</html> -->

<!--this is the css perfect notes-->

<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        body{
            overflow: hidden;
        }
        .container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
        }
        .profile-card {
            max-width: 300px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .survey-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .survey-button {
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .note-form, .code-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 20px;
        }
        .note-form label, .code-form label {
            margin-right: 10px;
        }
        .note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .note-form input[type="text"], .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button, .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover, .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
        .doctor-notes {

            max-height: 600px;
            overflow-y: auto;
            background-color: #f5f5f5;
            padding: 0px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 5px 15px;
            background-color: #e9ecef;
            border-left: 5px solid #007bff;
            margin-bottom: -40px;
        }
        .log-date {
            font-weight: bold;
            color: #007bff;
            margin-top: -25px;
            margin-bottom: -25px;
        }
        .log-note {
            margin: 5px 0;
            margin-bottom: -10px;
        }
        .textarea-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
       
        textarea {
            font-family: monospace;
            font-size: 16px;
            color: fieldtext;
            display: inline-block;
            resize: horizontal;
            cursor: text;
            overflow-wrap: break-word;
            background-color: field;
            margin: 0em;
            border-width: 1px;
            border-style: solid;
            border-color: rgb(118, 118, 118);
            padding: 10px;
            white-space: pre-wrap;
            width: calc(100% - 100px); /* Adjust width to account for the button width */
        }
        .textarea-container button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            height: 40px; /* Match the height of the textarea */
            margin-left: 15px;
        }
        .textarea-container button:hover {
            background-color: #0056b3;
        }
        .add-button{
            height: 35px;
            margin-left: 15px;
        }
    h3 {
    display: block;
    font-size: 1.17em;
    margin-block-start: 1em;
    margin-block-end: 1em;
    margin-inline-start: 0px;
    margin-inline-end: 0px;
    font-weight: bold;
    unicode-bidi: isolate;
    margin-top: -18px;
    margin-bottom: -51px;
    position: fixed;
}

    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="form-container">
            <div class="survey-buttons">
                <% if (surveyNames.length > 0) { %>
                    <% surveyNames.forEach(function(name) { %>
                        <form action="/generateGraph" method="POST" style="margin-bottom: 10px;">
                            <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                            <input type="hidden" name="surveyType" value="<%= name === 'Assessment of urinary incontinence in pregnancy (ICIQ-UI SF)' ? 'ICIQ-UI_SF' : name %>">
                            <button type="submit" class="survey-button">
                                <%= name %>
                            </button>
                        </form>
                    <% }); %>
                <% } else { %>
                    <p><strong>No surveys available for this patient.</strong></p>
                <% } %>
            </div>
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">ICD Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="note-form">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <div class="textarea-container">
                        <textarea id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required></textarea>
                        <button type="submit">Add</button>
                    </div>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            <h3>Doctor's Notes</h3>
            <div class="doctor-notes">
                <% if (doctorNotes.length > 0) { %>
                    <% doctorNotes.forEach(function(note) { %>
                        <div class="log-entry">
                            <div class="log-date"><%= note.date %></div>
                            <div class="log-note"><%= note.note %></div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p>No notes available</p>
                <% } %>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        // document.addEventListener("DOMContentLoaded", function() {
        //     $('#code').select2();
        //     var currentDate = new Date().toISOString().split('T')[0];
        //     document.getElementById("code_date").value = currentDate;
        // });

        // function showMessage(messageId) {
        //     const message = document.getElementById(messageId);
        //     message.style.display = 'inline';
        //     setTimeout(() => {
        //         message.style.display = 'none';
        //     }, 2000);
        // }

        // function submitForm(event, formId, messageId) {
        //     event.preventDefault();
        //     const form = document.getElementById(formId);
        //     const formData = $(form).serialize();

        //     $.ajax({
        //         type: "POST",
        //         url: form.action,
        //         data: formData,
        //         success: function(response) {
        //             showMessage(messageId);
        //             if (formId === 'doctor-note-form') {
        //                 const noteDate = new Date().toISOString().split('T')[0];
        //                 const noteText = document.getElementById('doctor-note').value;
        //                 addDoctorNoteToLog(noteDate, noteText);
        //                 document.getElementById('doctor-note').value = '';
        //             }
        //         },
        //         error: function() {
        //             alert('An error occurred. Please try again.');
        //         }
        //     });
        // }

        // function addDoctorNoteToLog(date, note) {
        //     const logContainer = document.querySelector('.doctor-notes');
        //     const newLogEntry = document.createElement('div');
        //     newLogEntry.className = 'log-entry';
        //     newLogEntry.innerHTML = `
        //         <div class="log-date">${date}</div>
        //         <div class="log-note">${note}</div>
        //     `;
        //     logContainer.appendChild(newLogEntry);
        // }
        

        document.addEventListener("DOMContentLoaded", function() {
    $('#code').select2();
    var currentDate = new Date().toISOString().split('T')[0];
    document.getElementById("code_date").value = currentDate;
});

function showMessage(messageId) {
    const message = document.getElementById(messageId);
    message.style.display = 'inline';
    setTimeout(() => {
        message.style.display = 'none';
    }, 2000);
}

function submitForm(event, formId, messageId) {
    event.preventDefault();
    const form = document.getElementById(formId);
    const formData = $(form).serialize();

    $.ajax({
        type: "POST",
        url: form.action,
        data: formData,
        success: function(response) {
            showMessage(messageId);
            if (formId === 'doctor-note-form') {
                const noteDate = new Date().toISOString().split('T')[0];
                const noteText = document.getElementById('doctor-note').value;
                addDoctorNoteToLog(noteDate, noteText);
                document.getElementById('doctor-note').value = '';
            }
        },
        error: function() {
            alert('An error occurred. Please try again.');
        }
    });
}

function addDoctorNoteToLog(date, note) {
    const logContainer = document.querySelector('.doctor-notes');
    const newLogEntry = document.createElement('div');
    newLogEntry.className = 'log-entry';
    newLogEntry.innerHTML = `
        <div class="log-date">${date}</div>
        <div class="log-note">${note}</div>
    `;
    logContainer.prepend(newLogEntry);
}

        


    </script>
</body>
</html>


 -->



 <!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        body {
            overflow: hidden;
        }
        .container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
        }
        .profile-card {
            max-width: 300px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .survey-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .survey-button {
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .note-form, .code-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 20px;
        }
        .note-form label, .code-form label {
            margin-right: 10px;
        }
        .note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .note-form input[type="text"], .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button, .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover, .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
        .doctor-notes {
            max-height: 600px;
            overflow-y: auto;
            background-color: #f5f5f5;
            padding: 0px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 5px 15px;
            background-color: #e9ecef;
            border-left: 5px solid #007bff;
        }
        .log-date {
            font-weight: bold;
            color: #007bff;
        }
        .log-note {
            margin: 5px 0;
        }
        .textarea-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        textarea {
            font-family: monospace;
            font-size: 16px;
            color: fieldtext;
            display: inline-block;
            resize: horizontal;
            cursor: text;
            overflow-wrap: break-word;
            background-color: field;
            margin: 0em;
            border-width: 1px;
            border-style: solid;
            border-color: rgb(118, 118, 118);
            padding: 10px;
            white-space: pre-wrap;
            width: calc(100% - 100px); /* Adjust width to account for the button width */
        }
        .textarea-container button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            height: 40px; /* Match the height of the textarea */
            margin-left: 15px;
        }
        .textarea-container button:hover {
            background-color: #0056b3;
        }
        .add-button {
            height: 35px;
            margin-left: 15px;
        }
        h3 {
            display: block;
            font-size: 1.17em;
            margin-block-start: 1em;
            margin-block-end: 1em;
            margin-inline-start: 0px;
            margin-inline-end: 0px;
            font-weight: bold;
            unicode-bidi: isolate;
            margin-top: -18px;
            margin-bottom: -51px;
            position: fixed;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="form-container">
            <div class="survey-buttons">
                <% if (surveyNames.length > 0) { %>
                    <% surveyNames.forEach(function(name) { %>
                        <form action="/generateGraph" method="POST" style="margin-bottom: 10px;">
                            <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                            <input type="hidden" name="surveyType" value="<%= name === 'Assessment of urinary incontinence in pregnancy (ICIQ-UI SF)' ? 'ICIQ-UI_SF' : name %>">
                            <button type="submit" class="survey-button">
                                <%= name %>
                            </button>
                        </form>
                    <% }); %>
                <% } else { %>
                    <p><strong>No surveys available for this patient.</strong></p>
                <% } %>
            </div>
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">ICD Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="note-form">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <div class="textarea-container">
                        <textarea id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required></textarea>
                        <button type="submit">Add</button>
                    </div>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            <h3>Doctor's Notes</h3>
            <div class="doctor-notes">
                <% if (doctorNotes.length > 0) { %>
                    <% doctorNotes.forEach(function(note) { %>
                        <div class="log-entry">
                            <div class="log-date"><%= note.date %></div>
                            <div class="log-note"><%= note.note %></div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p>No notes available</p>
                <% } %>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            $('#code').select2();
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = $(form).serialize();

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToLog(noteDate, noteText);
                        document.getElementById('doctor-note').value = '';
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToLog(date, note) {
            const logContainer = document.querySelector('.doctor-notes');
            const newLogEntry = document.createElement('div');
            newLogEntry.className = 'log-entry';
            newLogEntry.innerHTML = `
                <div class="log-date">${date}</div>
                <div class="log-note">${note}</div>
            `;
            logContainer.prepend(newLogEntry); // Append new log entry at the top
        }

    </script>
</body>
</html> -->


<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        body {
            overflow: hidden;
        }
        .container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
        }
        .profile-card {
            max-width: 300px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .survey-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .survey-button {
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .note-form, .code-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 20px;
        }
        .note-form label, .code-form label {
            margin-right: 10px;
        }
        .note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .note-form input[type="text"], .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button, .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover, .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
        .doctor-notes {
            max-height: 600px;
            overflow-y: auto;
            background-color: #f5f5f5;
            padding: 0px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 5px 15px;
            background-color: #e9ecef;
            border-left: 5px solid #007bff;
        }
        .log-date {
            font-weight: bold;
            color: #007bff;
            margin-top: -30px;
            margin-bottom: -30px;
        }
        .log-note {
            margin: 5px 0;
            margin-bottom: -20px;
        }
        .textarea-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        textarea {
            font-family: monospace;
            font-size: 16px;
            color: fieldtext;
            display: inline-block;
            resize: horizontal;
            cursor: text;
            overflow-wrap: break-word;
            background-color: field;
            margin: 0em;
            border-width: 1px;
            border-style: solid;
            border-color: rgb(118, 118, 118);
            padding: 10px;
            white-space: pre-wrap;
            width: calc(100% - 100px); /* Adjust width to account for the button width */
        }
        .textarea-container button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            height: 40px; /* Match the height of the textarea */
            margin-left: 15px;
        }
        .textarea-container button:hover {
            background-color: #0056b3;
        }
        .add-button {
            height: 35px;
            margin-left: 15px;
        }
        h3 {
            display: block;
            font-size: 1.17em;
            margin-block-start: 1em;
            margin-block-end: 1em;
            margin-inline-start: 0px;
            margin-inline-end: 0px;
            font-weight: bold;
            unicode-bidi: isolate;
            margin-top: -18px;
            margin-bottom: -51px;
            position: fixed;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="form-container">
            <div class="survey-buttons">
                <% if (surveyNames.length > 0) { %>
                    <% surveyNames.forEach(function(name) { %>
                        <form action="/generateGraph" method="POST" style="margin-bottom: 10px;">
                            <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                            <input type="hidden" name="surveyType" value="<%= name === 'Assessment of urinary incontinence in pregnancy (ICIQ-UI SF)' ? 'ICIQ-UI_SF' : name %>">
                            <button type="submit" class="survey-button">
                                <%= name %>
                            </button>
                        </form>
                    <% }); %>
                <% } else { %>
                    <p><strong>No surveys available for this patient.</strong></p>
                <% } %>
            </div>
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">ICD Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="note-form">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <div class="textarea-container">
                        <textarea id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required></textarea>
                        <button type="submit">Add</button>
                    </div>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            <h3>Doctor's Notes</h3>
            <div class="doctor-notes">
                <% if (doctorNotes.length > 0) { %>
                    <% doctorNotes.forEach(function(note) { %>
                        <div class="log-entry">
                            <div class="log-date"><%= note.date %></div>
                            <div class="log-note"><%= note.note %></div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p>No notes available</p>
                <% } %>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            $('#code').select2();
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = $(form).serialize();

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToLog(noteDate, noteText);
                        document.getElementById('doctor-note').value = '';
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToLog(date, note) {
            const logContainer = document.querySelector('.doctor-notes');
            const newLogEntry = document.createElement('div');
            newLogEntry.className = 'log-entry';
            newLogEntry.innerHTML = `
                <div class="log-date">${date}</div>
                <div class="log-note">${note}</div>
            `;
            logContainer.prepend(newLogEntry); // Append new log entry at the top
        }

    </script>
</body>
</html> -->




<!--this this the new code for implement of the thumbnails concept-->

<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        body {
            overflow: hidden;
        }
        .container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
        }
        .profile-card {
            max-width: 300px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .survey-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .survey-button {
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .note-form, .code-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 20px;
        }
        .note-form label, .code-form label {
            margin-right: 10px;
        }
        .note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .note-form input[type="text"], .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button, .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover, .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
        .doctor-notes {
            max-height: 600px;
            overflow-y: auto;
            background-color: #f5f5f5;
            padding: 0px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 5px 15px;
            background-color: #e9ecef;
            border-left: 5px solid #007bff;
        }
        .log-date {
            font-weight: bold;
            color: #007bff;
            margin-top: -30px;
            margin-bottom: -30px;
        }
        .log-note {
            margin: 5px 0;
            margin-bottom: -20px;
        }
        .textarea-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        textarea {
            font-family: monospace;
            font-size: 16px;
            color: fieldtext;
            display: inline-block;
            resize: horizontal;
            cursor: text;
            overflow-wrap: break-word;
            background-color: field;
            margin: 0em;
            border-width: 1px;
            border-style: solid;
            border-color: rgb(118, 118, 118);
            padding: 10px;
            white-space: pre-wrap;
            width: calc(100% - 100px); /* Adjust width to account for the button width */
        }
        .textarea-container button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            height: 40px; /* Match the height of the textarea */
            margin-left: 15px;
        }
        .textarea-container button:hover {
            background-color: #0056b3;
        }
        .add-button {
            height: 35px;
            margin-left: 15px;
        }
        h3 {
            display: block;
            font-size: 1.17em;
            margin-block-start: 1em;
            margin-block-end: 1em;
            margin-inline-start: 0px;
            margin-inline-end: 0px;
            font-weight: bold;
            unicode-bidi: isolate;
            margin-top: -18px;
            margin-bottom: -51px;
            position: fixed;
        }
        .image-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            justify-items: center;
            margin-bottom: 20px;
        }
        .image {
            position: relative;
            width: 100%;
            max-width: 300px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }
        .image:hover {
            transform: scale(1.05);
        }
        .image img {
            width: 100%;
            height: auto;
            vertical-align: middle;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            padding-top: 50px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.9);
        }
        .modal-content {
            margin: auto;
            display: block;
            width: 80%;
            max-width: 700px;
        }
        .modal-content img {
            width: 100%;
            height: auto;
        }
        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
        }
        .close:hover,
        .close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="image-container">
            <% surveyNames.forEach(function(name) { %>
                <div class="image" onclick="openModal('new_folder/plot_<%= name %>.jpg')">
                    <img src="new_folder/plot_<%= name %>.jpg" alt="<%= name %>">
                </div>
            <% }); %>
        </div>
        <div class="form-container">
            <div class="survey-buttons">
                <% if (surveyNames.length > 0) { %>
                    <% surveyNames.forEach(function(name) { %>
                        <form action="/generateGraph" method="POST" style="margin-bottom: 10px;">
                            <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                            <input type="hidden" name="surveyType" value="<%= name %>">
                            <button type="submit" class="survey-button">
                                <%= name %>
                            </button>
                        </form>
                    <% }); %>
                <% } else { %>
                    <p><strong>No surveys available for this patient.</strong></p>
                <% } %>
            </div>
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">ICD Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="note-form">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <div class="textarea-container">
                        <textarea id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required></textarea>
                        <button type="submit">Add</button>
                    </div>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            <h3>Doctor's Notes</h3>
            <div class="doctor-notes">
                <% if (doctorNotes.length > 0) { %>
                    <% doctorNotes.forEach(function(note) { %>
                        <div class="log-entry">
                            <div class="log-date"><%= note.date %></div>
                            <div class="log-note"><%= note.note %></div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p>No notes available</p>
                <% } %>
            </div>
        </div>
    </div>
    <div id="myModal" class="modal">
        <span class="close" onclick="closeModal()">&times;</span>
        <div class="modal-content">
            <img id="modalImage" src="" alt="Enlarged Image">
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            $('#code').select2();
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = $(form).serialize();

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToLog(noteDate, noteText);
                        document.getElementById('doctor-note').value = '';
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToLog(date, note) {
            const logContainer = document.querySelector('.doctor-notes');
            const newLogEntry = document.createElement('div');
            newLogEntry.className = 'log-entry';
            newLogEntry.innerHTML = `
                <div class="log-date">${date}</div>
                <div class="log-note">${note}</div>
            `;
            logContainer.prepend(newLogEntry); // Append new log entry at the top
        }

        function openModal(imageSrc) {
            const modal = document.getElementById('myModal');
            const modalImage = document.getElementById('modalImage');
            modalImage.src = imageSrc;
            modal.style.display = 'block';
        }

        function closeModal() {
            const modal = document.getElementById('myModal');
            modal.style.display = 'none';
        }

        window.onclick = function(event) {
            const modal = document.getElementById('myModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html> -->




<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        body {
            overflow: hidden;
        }
        .container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
        }
        .profile-card {
            max-width: 300px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .survey-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .survey-button {
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .note-form, .code-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 20px;
        }
        .note-form label, .code-form label {
            margin-right: 10px;
        }
        .note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .note-form input[type="text"], .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button, .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover, .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
        .doctor-notes {
            max-height: 600px;
            overflow-y: auto;
            background-color: #f5f5f5;
            padding: 0px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 5px 15px;
            background-color: #e9ecef;
            border-left: 5px solid #007bff;
        }
        .log-date {
            font-weight: bold;
            color: #007bff;
            margin-top: -30px;
            margin-bottom: -30px;
        }
        .log-note {
            margin: 5px 0;
            margin-bottom: -20px;
        }
        .textarea-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        textarea {
            font-family: monospace;
            font-size: 16px;
            color: fieldtext;
            display: inline-block;
            resize: horizontal;
            cursor: text;
            overflow-wrap: break-word;
            background-color: field;
            margin: 0em;
            border-width: 1px;
            border-style: solid;
            border-color: rgb(118, 118, 118);
            padding: 10px;
            white-space: pre-wrap;
            width: calc(100% - 100px); /* Adjust width to account for the button width */
        }
        .textarea-container button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            height: 40px; /* Match the height of the textarea */
            margin-left: 15px;
        }
        .textarea-container button:hover {
            background-color: #0056b3;
        }
        .add-button {
            height: 35px;
            margin-left: 15px;
        }
        h3 {
            display: block;
            font-size: 1.17em;
            margin-block-start: 1em;
            margin-block-end: 1em;
            margin-inline-start: 0px;
            margin-inline-end: 0px;
            font-weight: bold;
            unicode-bidi: isolate;
            margin-top: -18px;
            margin-bottom: -51px;
            position: fixed;
        }
        .image-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Two images per row */
            gap: 20px;
            justify-items: center;
            margin-bottom: 20px;
            margin-left: 320px; /* Add margin to prevent overlap with patient details */
        }
        .image {
            position: relative;
            width: 100%;
            max-width: 300px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }
        .image:hover {
            transform: scale(1.05);
        }
        .image img {
            width: 100%;
            height: auto;
            vertical-align: middle;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            padding-top: 50px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.9);
        }
        .modal-content {
            margin: auto;
            display: block;
            width: 80%;
            max-width: 700px;
        }
        .modal-content img {
            width: 100%;
            height: auto;
        }
        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
        }
        .close:hover,
        .close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="image-container">
            <% surveyNames.forEach(function(name) { %>
                <div class="image" onclick="openModal('new_folder/plot_<%= name %>.jpg')">
                    <img src="new_folder/plot_<%= name %>.jpg" alt="<%= name %>">
                </div>
            <% }); %>
        </div>
        <div class="form-container">
            <div class="survey-buttons">
                <% if (surveyNames.length > 0) { %>
                    <% surveyNames.forEach(function(name) { %>
                        <form action="/generateGraph" method="POST" style="margin-bottom: 10px;">
                            <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                            <input type="hidden" name="surveyType" value="<%= name %>">
                            <button type="submit" class="survey-button">
                                <%= name %>
                            </button>
                        </form>
                    <% }); %>
                <% } else { %>
                    <p><strong>No surveys available for this patient.</strong></p>
                <% } %>
            </div>
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">ICD Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="note-form">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <div class="textarea-container">
                        <textarea id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required></textarea>
                        <button type="submit">Add</button>
                    </div>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            <h3>Doctor's Notes</h3>
            <div class="doctor-notes">
                <% if (doctorNotes.length > 0) { %>
                    <% doctorNotes.forEach(function(note) { %>
                        <div class="log-entry">
                            <div class="log-date"><%= note.date %></div>
                            <div class="log-note"><%= note.note %></div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p>No notes available</p>
                <% } %>
            </div>
        </div>
    </div>
    <div id="myModal" class="modal">
        <span class="close" onclick="closeModal()">&times;</span>
        <div class="modal-content">
            <img id="modalImage" src="" alt="Enlarged Image">
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            $('#code').select2();
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = $(form).serialize();

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToLog(noteDate, noteText);
                        document.getElementById('doctor-note').value = '';
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToLog(date, note) {
            const logContainer = document.querySelector('.doctor-notes');
            const newLogEntry = document.createElement('div');
            newLogEntry.className = 'log-entry';
            newLogEntry.innerHTML = `
                <div class="log-date">${date}</div>
                <div class="log-note">${note}</div>
            `;
            logContainer.prepend(newLogEntry); // Append new log entry at the top
        }

        function openModal(imageSrc) {
            const modal = document.getElementById('myModal');
            const modalImage = document.getElementById('modalImage');
            modalImage.src = imageSrc;
            modal.style.display = 'block';
        }

        function closeModal() {
            const modal = document.getElementById('myModal');
            modal.style.display = 'none';
        }

        window.onclick = function(event) {
            const modal = document.getElementById('myModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html>
 -->


<!--this is the code for thumbnails and button together-->


<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        body {
            overflow: hidden;
        }
        .container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
        }
        .profile-card {
            max-width: 300px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .survey-buttons {
            display: flex;
            /* display: block; */
            flex-wrap: wrap;
            gap: 0px;

        }
        .survey-button {
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .note-form, .code-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 20px;
        }
        .note-form label, .code-form label {
            margin-right: 10px;
        }
        .note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .note-form input[type="text"], .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button, .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover, .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
        .doctor-notes {
            max-height: 600px;
            overflow-y: auto;
            background-color: #f5f5f5;
            padding: 0px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 5px 15px;
            background-color: #e9ecef;
            border-left: 5px solid #007bff;
        }
        .log-date {
            font-weight: bold;
            color: #007bff;
            margin-top: -30px;
            margin-bottom: -30px;
        }
        .log-note {
            margin: 5px 0;
            margin-bottom: -20px;
        }
        .textarea-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        textarea {
            font-family: monospace;
            font-size: 16px;
            color: fieldtext;
            display: inline-block;
            resize: horizontal;
            cursor: text;
            overflow-wrap: break-word;
            background-color: field;
            margin: 0em;
            border-width: 1px;
            border-style: solid;
            border-color: rgb(118, 118, 118);
            padding: 10px;
            white-space: pre-wrap;
            width: calc(100% - 100px); /* Adjust width to account for the button width */
        }
        .textarea-container button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            height: 40px; /* Match the height of the textarea */
            margin-left: 15px;
        }
        .textarea-container button:hover {
            background-color: #0056b3;
        }
        .add-button {
            height: 35px;
            margin-left: 15px;
        }
        h3 {
            display: block;
            font-size: 1.17em;
            margin-block-start: 1em;
            margin-block-end: 1em;
            margin-inline-start: 0px;
            margin-inline-end: 0px;
            font-weight: bold;
            unicode-bidi: isolate;
            margin-top: -18px;
            margin-bottom: -51px;
            position: fixed;
        }
        .image-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Two images per row */
            gap: 20px;
            justify-items: center;
            margin-bottom: 20px;
            margin-left: 320px; /* Add margin to prevent overlap with patient details */
        }
        .image {
            position: relative;
            width: 100%;
            max-width: 300px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .image:hover {
            transform: scale(1.05);
        }
        .image img {
            width: 100%;
            height: auto;
            vertical-align: middle;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            padding-top: 50px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.9);
        }
        .modal-content {
            margin: auto;
            display: block;
            width: 80%;
            max-width: 700px;
        }
        .modal-content img {
            width: 100%;
            height: auto;
        }
        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
        }
        .close:hover,
        .close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="form-container">
            <div class="survey-buttons">
                <% if (surveyNames.length > 0) { %>
                    <% surveyNames.forEach(function(name) { %>
                        <div class="image">
                            <img src="new_folder/plot_<%= name %>.jpg" alt="<%= name %>" onclick="openModal('new_folder/plot_<%= name %>.jpg')">
                            <form action="/generateGraph" method="POST">
                                <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                                <input type="hidden" name="surveyType" value="<%= name %>">
                                <button type="submit" class="survey-button">
                                    <%= name %>
                                </button>
                            </form>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p><strong>No surveys available for this patient.</strong></p>
                <% } %>
            </div>
        </div>
        <div class="form-container">
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">ICD Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="note-form">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <div class="textarea-container">
                        <textarea id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required></textarea>
                        <button type="submit">Add</button>
                    </div>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            <h3>Doctor's Notes</h3>
            <div class="doctor-notes">
                <% if (doctorNotes.length > 0) { %>
                    <% doctorNotes.forEach(function(note) { %>
                        <div class="log-entry">
                            <div class="log-date"><%= note.date %></div>
                            <div class="log-note"><%= note.note %></div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p>No notes available</p>
                <% } %>
            </div>
        </div>
    </div>
    <div id="myModal" class="modal">
        <span class="close" onclick="closeModal()">&times;</span>
        <div class="modal-content">
            <img id="modalImage" src="" alt="Enlarged Image">
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            $('#code').select2();
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = $(form).serialize();

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToLog(noteDate, noteText);
                        document.getElementById('doctor-note').value = '';
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToLog(date, note) {
            const logContainer = document.querySelector('.doctor-notes');
            const newLogEntry = document.createElement('div');
            newLogEntry.className = 'log-entry';
            newLogEntry.innerHTML = `
                <div class="log-date">${date}</div>
                <div class="log-note">${note}</div>
            `;
            logContainer.prepend(newLogEntry); // Append new log entry at the top
        }

        function openModal(imageSrc) {
            const modal = document.getElementById('myModal');
            const modalImage = document.getElementById('modalImage');
            modalImage.src = imageSrc;
            modal.style.display = 'block';
        }

        function closeModal() {
            const modal = document.getElementById('myModal');
            modal.style.display = 'none';
        }

        window.onclick = function(event) {
            const modal = document.getElementById('myModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html> -->



<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        body {
            overflow: hidden;
        }
        .container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
        }
        .profile-card {
            max-width: 300px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .survey-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        .survey-button {
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .note-form, .code-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 20px;
        }
        .note-form label, .code-form label {
            margin-right: 10px;
        }
        .note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .note-form input[type="text"], .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button, .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover, .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
        .doctor-notes {
            max-height: 600px;
            overflow-y: auto;
            background-color: #f5f5f5;
            padding: 0px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 5px 15px;
            background-color: #e9ecef;
            border-left: 5px solid #007bff;
        }
        .log-date {
            font-weight: bold;
            color: #007bff;
            margin-top: -30px;
            margin-bottom: -30px;
        }
        .log-note {
            margin: 5px 0;
            margin-bottom: -20px;
        }
        .textarea-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        textarea {
            font-family: monospace;
            font-size: 16px;
            color: fieldtext;
            display: inline-block;
            resize: horizontal;
            cursor: text;
            overflow-wrap: break-word;
            background-color: field;
            margin: 0em;
            border-width: 1px;
            border-style: solid;
            border-color: rgb(118, 118, 118);
            padding: 10px;
            white-space: pre-wrap;
            width: calc(100% - 100px); /* Adjust width to account for the button width */
        }
        .textarea-container button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            height: 40px; /* Match the height of the textarea */
            margin-left: 15px;
        }
        .textarea-container button:hover {
            background-color: #0056b3;
        }
        .add-button {
            height: 35px;
            margin-left: 15px;
        }
        h3 {
            display: block;
            font-size: 1.17em;
            margin-block-start: 1em;
            margin-block-end: 1em;
            margin-inline-start: 0px;
            margin-inline-end: 0px;
            font-weight: bold;
            unicode-bidi: isolate;
            margin-top: -18px;
            margin-bottom: -51px;
            position: fixed;
        }
        .image-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Two images per row */
            gap: 20px;
            justify-items: center;
            margin-bottom: 20px;
            margin-left: 320px; /* Add margin to prevent overlap with patient details */
        }
        .image {
            position: relative;
            width: 100%;
            max-width: 275px; /* Adjusted size */
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .image:hover {
            transform: scale(1.05);
        }
        .image img {
            width: 100%;
            height: auto;
            vertical-align: middle;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            padding-top: 50px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.9);
        }
        .modal-content {
            margin: auto;
            display: block;
            width: 80%;
            max-width: 700px;
        }
        .modal-content img {
            width: 100%;
            height: auto;
        }
        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
        }
        .close:hover,
        .close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="image-container">
            <% surveyNames.forEach(function(name) { %>
                <div class="image">
                    <img src="new_folder/plot_<%= name %>.jpg" alt="<%= name %>" onclick="openModal('new_folder/plot_<%= name %>.jpg')">
                    <form action="/generateGraph" method="POST">
                        <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                        <input type="hidden" name="surveyType" value="<%= name %>">
                        <button type="submit" class="survey-button">
                            <%= name %>
                        </button>
                    </form>
                </div>
            <% }); %>
        </div>
        <div class="form-container">
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">ICD Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="note-form">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <div class="textarea-container">
                        <textarea id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required></textarea>
                        <button type="submit">Add</button>
                    </div>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            <h3>Doctor's Notes</h3>
            <div class="doctor-notes">
                <% if (doctorNotes.length > 0) { %>
                    <% doctorNotes.forEach(function(note) { %>
                        <div class="log-entry">
                            <div class="log-date"><%= note.date %></div>
                            <div class="log-note"><%= note.note %></div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p>No notes available</p>
                <% } %>
            </div>
        </div>
    </div>
    <div id="myModal" class="modal">
        <span class="close" onclick="closeModal()">&times;</span>
        <div class="modal-content">
            <img id="modalImage" src="" alt="Enlarged Image">
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            $('#code').select2();
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = $(form).serialize();

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToLog(noteDate, noteText);
                        document.getElementById('doctor-note').value = '';
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToLog(date, note) {
            const logContainer = document.querySelector('.doctor-notes');
            const newLogEntry = document.createElement('div');
            newLogEntry.className = 'log-entry';
            newLogEntry.innerHTML = `
                <div class="log-date">${date}</div>
                <div class="log-note">${note}</div>
            `;
            logContainer.prepend(newLogEntry); // Append new log entry at the top
        }

        function openModal(imageSrc) {
            const modal = document.getElementById('myModal');
            const modalImage = document.getElementById('modalImage');
            modalImage.src = imageSrc;
            modal.style.display = 'block';
        }

        function closeModal() {
            const modal = document.getElementById('myModal');
            modal.style.display = 'none';
        }

        window.onclick = function(event) {
            const modal = document.getElementById('myModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html> -->


<!--this code is perfect working -->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Details</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        body {
            overflow: hidden;
        }
        .container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
        }
        .profile-card {
            max-width: 300px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex-grow: 1;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .survey-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        .survey-button {
            padding: 10px;
            background-color: #28a745;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }
        .survey-button:hover {
            background-color: #218838;
        }
        .highlight {
            font-weight: bold;
            color: #007bff;
        }
        .note-form, .code-form {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 20px;
        }
        .note-form label, .code-form label {
            margin-right: 10px;
        }
        .note-form input[type="text"], .note-form input[type="date"], .note-form button, .code-form select, .code-form button {
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .note-form input[type="text"], .code-form select {
            width: 200px;
        }
        .note-form input[type="date"] {
            width: 150px;
        }
        .note-form button, .code-form button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .note-form button:hover, .code-form button:hover {
            background-color: #0056b3;
        }
        .code-form select {
            width: 400px;
        }
        .success-message {
            color: green;
            display: none;
            margin-left: 10px;
        }
        .doctor-notes {
            max-height: 600px;
            overflow-y: auto;
            background-color: #f5f5f5;
            padding: 0px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 5px 15px;
            background-color: #e9ecef;
            border-left: 5px solid #007bff;
        }
        .log-date {
            font-weight: bold;
            color: #007bff;
            margin-top: -30px;
            margin-bottom: -30px;
        }
        .log-note {
            margin: 5px 0;
            margin-bottom: -20px;
        }
        .textarea-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        textarea {
            font-family: monospace;
            font-size: 16px;
            color: fieldtext;
            display: inline-block;
            resize: horizontal;
            cursor: text;
            overflow-wrap: break-word;
            background-color: field;
            margin: 0em;
            border-width: 1px;
            border-style: solid;
            border-color: rgb(118, 118, 118);
            padding: 10px;
            white-space: pre-wrap;
            width: calc(100% - 100px); /* Adjust width to account for the button width */
        }
        .textarea-container button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            height: 40px; /* Match the height of the textarea */
            margin-left: 15px;
        }
        .textarea-container button:hover {
            background-color: #0056b3;
        }
        .add-button {
            height: 35px;
            margin-left: 15px;
        }
        h3 {
            display: block;
            font-size: 1.17em;
            margin-block-start: 1em;
            margin-block-end: 1em;
            margin-inline-start: 0px;
            margin-inline-end: 0px;
            font-weight: bold;
            unicode-bidi: isolate;
            margin-top: -18px;
            margin-bottom: -51px;
            position: fixed;
        }
        .image-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Two images per row */
            gap: 20px;
            justify-items: center;
            margin-bottom: 20px;
            margin-left: 320px; /* Add margin to prevent overlap with patient details */
        }
        .image {
            position: relative;
            width: 100%;
            max-width: 275px; /* Adjusted size */
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .image:hover {
            transform: scale(1.05);
        }
        .image img {
            width: 100%;
            height: auto;
            vertical-align: middle;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            padding-top: 50px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.9);
        }
        .modal-content {
            margin: auto;
            display: block;
            width: 80%;
            max-width: 700px;
        }
        .modal-content img {
            width: 100%;
            height: auto;
        }
        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
        }
        .close:hover,
        .close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <h2>Patient Details</h2>
            <p><span class="highlight">Mr_no:</span> <%= patient.Mr_no %></p>
            <p><span class="highlight">Name:</span> <%= patient.Name %></p>
            <p><span class="highlight">Date of Birth:</span> <%= patient.DOB %></p>
            <p><span class="highlight">Date and Time:</span> <%= patient.datetime %></p>
            <p><span class="highlight">Speciality:</span> <%= patient.speciality %></p>
            <p><span class="highlight">Date of Surgery:</span> <%= patient.dateOfSurgery %></p>
            <p><span class="highlight">Phone Number:</span> <%= patient.phoneNumber %></p>
        </div>
        <div class="image-container">
            <% surveyNames.forEach(function(name) { %>
                <div class="image">
                    <img src="new_folder/plot_<%= name %>.jpg" alt="<%= name %>" onerror="this.src='new_folder/plot_EPDS.jpg'" onclick="openModal('new_folder/plot_<%= name %>.jpg')">
                    <form action="/generateGraph" method="POST">
                        <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                        <input type="hidden" name="surveyType" value="<%= name %>">
                        <button type="submit" class="survey-button">
                            <%= name %>
                        </button>
                    </form>
                </div>
            <% }); %>
        </div>
        <div class="form-container">
            <div class="note-form">
                <form id="note-form" action="/addNote" method="POST" onsubmit="submitForm(event, 'note-form', 'note-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="note">Intervention:</label>
                    <input type="text" id="note" name="event" placeholder="Enter your Intervention here" required>
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="note-message">Successfully added!</span>
                </form>
            </div>
            <div class="code-form">
                <form id="code-form" action="/addCode" method="POST" onsubmit="submitForm(event, 'code-form', 'code-message')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="code">ICD Code:</label>
                    <select id="code" name="code" required>
                        <option value="" disabled selected>Select a code</option>
                        <% codes.forEach(function(code) { %>
                            <option value="<%= code.code %>"><%= code.description %></option>
                        <% }); %>
                    </select>
                    <input type="hidden" id="code_date" name="code_date">
                    <button type="submit" class="add-button">Add</button>
                    <span class="success-message" id="code-message">Successfully added!</span>
                </form>
            </div>
            <div class="note-form">
                <form id="doctor-note-form" action="/addDoctorNote" method="POST" onsubmit="submitForm(event, 'doctor-note-form', 'note-doctor')">
                    <input type="hidden" name="Mr_no" value="<%= patient.Mr_no %>">
                    <label for="doctor-note">Doctor's Note:</label>
                    <div class="textarea-container">
                        <textarea id="doctor-note" name="doctorNote" placeholder="Enter doctor's note here" required></textarea>
                        <button type="submit">Add</button>
                    </div>
                    <span class="success-message" id="note-doctor">Successfully added!</span>
                </form>
            </div>
            <h3>Doctor's Notes</h3>
            <div class="doctor-notes">
                <% if (doctorNotes.length > 0) { %>
                    <% doctorNotes.forEach(function(note) { %>
                        <div class="log-entry">
                            <div class="log-date"><%= note.date %></div>
                            <div class="log-note"><%= note.note %></div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p>No notes available</p>
                <% } %>
            </div>
        </div>
    </div>
    <div id="myModal" class="modal">
        <span class="close" onclick="closeModal()">&times;</span>
        <div class="modal-content">
            <img id="modalImage" src="" alt="Enlarged Image">
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            $('#code').select2();
            var currentDate = new Date().toISOString().split('T')[0];
            document.getElementById("code_date").value = currentDate;
        });

        function showMessage(messageId) {
            const message = document.getElementById(messageId);
            message.style.display = 'inline';
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        function submitForm(event, formId, messageId) {
            event.preventDefault();
            const form = document.getElementById(formId);
            const formData = $(form).serialize();

            $.ajax({
                type: "POST",
                url: form.action,
                data: formData,
                success: function(response) {
                    showMessage(messageId);
                    if (formId === 'doctor-note-form') {
                        const noteDate = new Date().toISOString().split('T')[0];
                        const noteText = document.getElementById('doctor-note').value;
                        addDoctorNoteToLog(noteDate, noteText);
                        document.getElementById('doctor-note').value = '';
                    }
                },
                error: function() {
                    alert('An error occurred. Please try again.');
                }
            });
        }

        function addDoctorNoteToLog(date, note) {
            const logContainer = document.querySelector('.doctor-notes');
            const newLogEntry = document.createElement('div');
            newLogEntry.className = 'log-entry';
            newLogEntry.innerHTML = `
                <div class="log-date">${date}</div>
                <div class="log-note">${note}</div>
            `;
            logContainer.prepend(newLogEntry); // Append new log entry at the top
        }

        function openModal(imageSrc) {
            const modal = document.getElementById('myModal');
            const modalImage = document.getElementById('modalImage');
            modalImage.src = imageSrc;
            modal.style.display = 'block';
        }

        function closeModal() {
            const modal = document.getElementById('myModal');
            modal.style.display = 'none';
        }

        window.onclick = function(event) {
            const modal = document.getElementById('myModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html>
