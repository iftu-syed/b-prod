<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Urinary Incontinence Survey (ICIQ-UI SF)</title>
  <link rel="stylesheet" href="/styles/ICIQsurvey.css">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Urbanist:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
</head>

<body>
  <button class="lang-toggle" onclick="toggleLanguage()">العربية</button>

  <div class="parentrow">
    <div class="parentcolumn left">
      <div class="sidebar">
        <hr class="spacer">
        <img src="/assets/images/logo.png">
        <hr class="spacer">
        <div class="sidebar-item-done">Wexner <i class='bx bx-check-circle' style="font-size: 20px;"></i></div>
        <div class="sidebar-item-active">ICIQ-UI SF</div>
        <div class="sidebar-item-inactive">EPDS</div>
        <div class="sidebar-item-inactive">PROMIS-10</div>
      </div>
    </div>

    <div class="parentcolumn right">
      <div class="infobox">
        <div class="mobile-container">

          <img src="/assets/images/logo.png">
  
          
        </div>

        <h1 data-en="Urinary Incontinence Survey (ICIQ-UI SF)" data-ar="استبيان سلس البول (ICIQ-UI SF)">
          Urinary Incontinence Survey (ICIQ-UI SF)
      </h1>

      <p id="text" class="info-text" >
        PROMIS-10 Global Health is a brief survey that assesses your overall health across physical, mental, and social aspects. It's a quick way to track your health over time and helps doctors understand your concerns from your perspective.
        <span id="dots" style="display:none;">...</span>
        <span id="more-text" style="display:none;"></span>
        <span id="toggle-btn" onclick="toggleText()" style="color: blue; cursor: pointer; display:none;"> Show More</span>
      </p>
        <hr class="spacer">
        <div class="progress-bar">
          <div class="progress" id="progress-bar"></div>
        </div>
      </div>

      <form action="/submit_ICIQ-UI_SF" method="post" class="surveyform">
        <input type="hidden" name="Mr_no" value="<%= Mr_no %>">
        <input type="hidden" id="selectedLang" name="selectedLang" value="en"> <!-- This line ensures that the current language is passed -->

        <!-- Question 1 -->
        <div class="question-container active" id="question-1">
          <!-- <div class="back-button">
            <button type="button" onclick="previousQuestion()"><i class='bx bx-chevrons-left'></i>Previous</button>
          </div> -->
      <p class="question-text data-en="How often do you leak urine? (Tick one box)" data-ar="كم مرة يتسرب البول؟ (ضع علامة في المربع المناسب)">Q.1: How often do you leak urine? (Select one)</p>

      <div id="form-wrapper">
        <div class="responsive-grid-radio">
            <div class="radio-grid">
                <input type="radio" name="How often do you leak urine?" id="urine_6" value="1" required>
                <label for="urine_6" data-en="Never" data-ar="أبدا">Never</label>
            </div>
            <div class="radio-grid">
                <input type="radio" name="How often do you leak urine?" id="urine_7" value="2" required>
                <label for="urine_7" data-en="Once a week or less" data-ar="حوالي مرة واحدة في الأسبوع أو أقل">Once a week or less</label>
            </div>
            <div class="radio-grid">
                <input type="radio" name="How often do you leak urine?" id="urine_8" value="3" required>
                <label for="urine_8" data-en="Once a day" data-ar="حوالي مرة واحدة في اليوم">Once a day</label>
            </div>
            <div class="radio-grid">
                <input type="radio" name="How often do you leak urine?" id="urine_9" value="4" required>
                <label for="urine_9" data-en="Several times a day" data-ar="عدة مرات في اليوم">Several times a day</label>
            </div>
            <div class="radio-grid">
                <input type="radio" name="How often do you leak urine?" id="urine_0" value="5" required>
                <label for="urine_0" data-en="All the time" data-ar="طوال الوقت">All the time</label>
            </div>
        </div>
      </div>

      <div id="custom-radio-pos"></div>
      <div id="form-wrapper-desktop">
        <div id="custom-radio">


      <input type="radio" name="How often do you leak urine?" id="urine_1" value="1" required>
      <label for="urine_1" data-en="Never" data-ar="أبدا">Never</label> 
      <input type="radio" name="How often do you leak urine?" id="urine_2" value="2" required>
      <label for="urine_2" data-en="Once a week or less" data-ar="حوالي مرة واحدة في الأسبوع أو أقل">Once a week or less</label>
      <input type="radio" name="How often do you leak urine?" id="urine_3" value="3" required>
      <label for="urine_3" data-en="Once a day" data-ar="حوالي مرة واحدة في اليوم">Once a day</label>
      <input type="radio" name="How often do you leak urine?" id="urine_4" value="4" required>
      <label for="urine_4" data-en="Several times a day" data-ar="عدة مرات في اليوم">Several times a day</label>
      <input type="radio" name="How often do you leak urine?" id="urine_5" value="5" required>
      <label for="urine_5" data-en="All the time" data-ar="طوال الوقت">All the time</label>
      <div id="custom-radio-pos"></div>

    </div>

      </div>
  </div>


        <!-- Question 2 -->
        <div class="question-container" id="question-2">
          <div class="back-button">
            <button type="button" onclick="previousQuestion()"><i class='bx bx-chevrons-left'></i>Previous</button>
          </div>
          <p data-en="How much urine do you usually leak? (Tick one box)" data-ar="ما مقدار البول الذي يتسرب عادة؟ (ضع علامة في المربع المناسب)">Q.2: How much urine do you usually leak? (Select one)</p>
    
          <div id="form-wrapper">
            <div class="responsive-grid-radio">
                <div class="radio-grid">
                    <input type="radio" name="How much urine do you usually leak?" id="urine1_6" value="1" required>
                    <label for="urine1_6" data-en="None" data-ar="لا شيء">None</label>
                </div>
                <div class="radio-grid">
                    <input type="radio" name="How much urine do you usually leak?" id="urine1_7" value="2" required>
                    <label for="urine1_7" data-en="A Small amount" data-ar="كمية صغيرة">A Small amount</label>
                </div>
                <div class="radio-grid">
                    <input type="radio" name="How much urine do you usually leak?" id="urine1_8" value="3" required>
                    <label for="urine1_8"data-en="A Moderate amount" data-ar="كمية معتدلة">A Moderate amount</label>
                </div>
                <div class="radio-grid">
                    <input type="radio" name="How much urine do you usually leak?" id="urine1_9" value="4" required>
                    <label for="urine1_9" data-en="A Large amount" data-ar="كمية كبيرة">A Large amount</label>
                </div>
                <div class="radio-grid">
                    <input type="radio" name="How much urine do you usually leak?" id="urine1_0" value="5" required>
                    <label for="urine1_0" data-en="All of it" data-ar="طوال الوقت">All of it</label>
                </div>
            </div>
          </div>
    
          <div id="custom-radio-pos"></div>
          <div id="form-wrapper-desktop">
            <div id="custom-radio">
    
    
    
          <input type="radio" name="How much urine do you usually leak?" id="urine1_1" value="1" required>
          <label for="urine1_1" data-en="None" data-ar="لا شيء">None</label> 
          <input type="radio" name="How much urine do you usually leak?" id="urine1_2" value="2" required>
          <label for="urine1_2" data-en="A Small amount" data-ar="كمية صغيرة">A Small Amount</label>
          <input type="radio" name="How much urine do you usually leak?" id="urine1_3" value="3" required>
          <label for="urine1_3">A moderate amount</label>
          <input type="radio" name="How much urine do you usually leak?" id="urine1_4" value="4" required>
          <label for="urine1_4" data-en="A Large Amount" data-ar="كمية كبيرة">A Large Amount</label>
          <input type="radio" name="How much urine do you usually leak?" id="urine1_5" value="5" required>
          <label for="urine1_5" data-en="All of it" data-ar="طوال الوقت">All of it</label>
          <div id="custom-radio-pos"></div>
        </div>
    
      </div>
    </div>

        <!-- Question 3 -->
        <div class="question-container" id="question-3">
          <div class="back-button">
            <button type="button" onclick="previousQuestion()"><i class='bx bx-chevrons-left'></i>Previous</button>
          </div>
          <p data-en="Overall, how much does leaking urine interfere with your everyday life?" data-ar="بشكل عام، ما مدى تأثير تسرب البول على حياتك اليومية؟">Q.3: Overall, how much does leaking urine interfere with your everyday life?</p>
          
          <div class="horizontal-options" style="display: flex; justify-content: center;">
            <span data-en="0 (not at all)" data-ar="0 (لا شيء على الإطلاق)">(not at all)<--</span>
            <% for(let i = 0; i <= 10; i++) { %>
              <label>
                <input type="radio" name="Overall, how much does leaking urine interfere with your everyday life?" value="<%= i %>" required> <%= i %>
              </label>
            <% } %>
            <span data-en="10 (a great deal)" data-ar="10 (بقدر كبير)">-->(a great deal)</span>
          </div>
    
        </div>

        <!-- Question 4 -->
        <div class="question-container" id="question-4">
          <div class="back-button">
            <button type="button" onclick="previousQuestion()"><i class='bx bx-chevrons-left'></i>Previous</button>
          </div>
          <p data-en="When does urine leak? (Please tick all that apply to you)" data-ar="متى يتسرب البول؟ (يرجى وضع علامة على جميع الخيارات التي تنطبق عليك)">Q.4: When does urine leak? (Please tick all that apply to you)</p>
    
          <div id="form-wrapper">
            <label><input type="checkbox" name="When does urine leak?" value="never – urine does not leak"> <span data-en="never – urine does not leak" data-ar="أبدا - لا يتسرب البول">never – urine does not leak</span></label><br>
          <label><input type="checkbox" name="When does urine leak?" value="leaks before you can get to the toilet"> <span data-en="leaks before you can get to the toilet" data-ar="يتسرب قبل أن تتمكن من الوصول إلى الحمام">leaks before you can get to the toilet</span></label><br>
          <label><input type="checkbox" name="When does urine leak?" value="leaks when you cough or sneeze"> <span data-en="leaks when you cough or sneeze" data-ar="يتسرب عند السعال أو العطس">leaks when you cough or sneeze</span></label><br>
          <label><input type="checkbox" name="When does urine leak?" value="leaks when you are asleep"> <span data-en="leaks when you are asleep" data-ar="يتسرب عندما تكون نائم">leaks when you are asleep</span></label><br>
          <label><input type="checkbox" name="When does urine leak?" value="leaks when you are physically active/exercising"> <span data-en="leaks when you are physically active/exercising" data-ar="يتسرب عندما تكون نشطًا بدنيًا/تمارس الرياضة">leaks when you are physically active/exercising</span></label><br>
          <label><input type="checkbox" name="When does urine leak?" value="leaks when you have finished urinating and are dressed"> <span data-en="leaks when you have finished urinating and are dressed" data-ar="يتسرب بعد الانتهاء من التبول وبعد أن ترتدي ملابسك">leaks when you have finished urinating and are dressed</span></label><br>
          <label><input type="checkbox" name="When does urine leak?" value="leaks for no obvious reason"> <span data-en="leaks for no obvious reason" data-ar="يتسرب بدون سبب واضح">leaks for no obvious reason</span></label><br>
          <label><input type="checkbox" name="When does urine leak?" value="leaks all the time"> <span data-en="leaks all the time" data-ar="يتسرب طوال الوقت">leaks all the time</span></label>

          
          
          </div>



          
        </div>
        <div class="nav-buttons">
          <button type="submit"><i class='bx bx-check-double'></i> Submit</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    let currentLang = 'en';
  let currentQuestion = 0;
  const questions = document.querySelectorAll('.question-container');
  const progressBar = document.getElementById('progress-bar');
  
  function updateProgressBar() {
    const progress = ((currentQuestion + 1) / questions.length) * 100;
    progressBar.style.width = `${progress}%`;
  }
  
  function showQuestion(index) {
    questions.forEach((question, i) => {
      question.classList.toggle('active', i === index);
    });
    updateProgressBar();
    
    // Check if we're at the last question
    const submitButton = document.querySelector('.nav-buttons button[type="submit"]');
    if (currentQuestion === questions.length - 1) {
      submitButton.style.display = 'block'; // Show submit button
    } else {
      submitButton.style.display = 'none'; // Hide submit button
    }
  }

  var charLimit = 80;

function toggleText() {
  var dots = document.getElementById("dots");
  var moreText = document.getElementById("more-text");
  var toggleBtn = document.getElementById("toggle-btn");

  if (moreText.style.display === "none") {
    dots.style.display = "none"; // Hide the dots
    moreText.style.display = "inline"; // Show the extra text
    toggleBtn.innerHTML = " Show Less"; // Change text to "Show Less"
  } else {
    dots.style.display = "inline"; // Show the dots
    moreText.style.display = "none"; // Hide the extra text
    toggleBtn.innerHTML = " Show More"; // Change text back to "Show More"
  }
}

// Function to handle truncation based on screen size (mobile vs desktop)
function setInitialText() {
  var fullText = "PROMIS-10 Global Health is a brief survey that assesses your overall health across physical, mental, and social aspects. It's a quick way to track your health over time and helps doctors understand your concerns from your perspective."; 
  var truncatedText = fullText.substring(0, charLimit); // Get the first 100 characters

  // Check if the screen size is mobile
  if (window.innerWidth < 768) {
    // On mobile, truncate the text if it exceeds the character limit
    if (fullText.length > charLimit) {
      document.getElementById("text").innerHTML = 
        truncatedText + 
        '<span id="dots">...</span>' +
        '<span id="more-text" style="display:none;">' + 
        fullText.substring(charLimit) + 
        '</span>' + 
        '<span id="toggle-btn" style="color: blue; cursor: pointer;" onclick="toggleText()"> Show More</span>';
    } else {
      // If text is within the character limit, show the full text
      document.getElementById("text").innerHTML = fullText;
    }
  } else {
    // On desktop, show the full text without truncation and without "Show More"
    document.getElementById("text").innerHTML = fullText;
  }
}

// Call setInitialText on page load and when the window is resized
window.onload = setInitialText;
window.onresize = setInitialText;
  
  function nextQuestion() {
    const currentInputs = questions[currentQuestion].querySelectorAll('input[type="radio"]');
    let answered = false;
  
    currentInputs.forEach(input => {
      if (input.checked) {
        answered = true;
      }
    });
  
    if (answered) {
            if (currentQuestion < questions.length - 1) {
              setTimeout(() => {
                currentQuestion++;
                showQuestion(currentQuestion)
              }, 500);
            }
                
        }
  }
  function previousQuestion() {
    if (currentQuestion > 0) {
      currentQuestion--;
      showQuestion(currentQuestion);
  
      // Reattach the event listeners after showing the previous question
      addRadioEventListeners();
    }
  }
  
  function addRadioEventListeners() {
    questions.forEach((question, questionIndex) => {
      const radioInputs = question.querySelectorAll('input[type="radio"]');
  
      radioInputs.forEach(input => {
        // Remove any existing event listener before adding a new one to avoid multiple triggers
        input.removeEventListener('click', handleRadioClick);
        input.addEventListener('click', handleRadioClick);
      });
    });
  }
  
  function handleRadioClick() {
    if (currentQuestion === questions.length - 1) {
      return; // Do nothing if we are on the last question
    }
    nextQuestion();
  }
  
  
  
  // function toggleLanguage() {
  //     currentLang = currentLang === 'en' ? 'ar' : 'en';
      
  //     // Loop through all question containers
  //     questions.forEach(question => {
  //         const enContent = question.querySelector('.en-content');
  //         const arContent = question.querySelector('.ar-content');
          
  //         // Toggle visibility of language-specific content for each question
  //         if (enContent && arContent) {
  //             enContent.style.display = currentLang === 'en' ? 'block' : 'none';
  //             arContent.style.display = currentLang === 'en' ? 'none' : 'block';
  //         }
  //     });
      
  //     // Update the toggle button text
  //     document.querySelector('.lang-toggle').innerText = currentLang === 'en' ? 'العربية' : 'English';
  // }
  


//   function toggleLanguage() {
//     currentLang = currentLang === 'en' ? 'ar' : 'en';
    
//     // Update the hidden language input field
//     document.getElementById('selectedLang').value = currentLang;
    
//     // Loop through all question containers
//     questions.forEach(question => {
//         const enContent = question.querySelector('.en-content');
//         const arContent = question.querySelector('.ar-content');
        
//         // Toggle visibility of language-specific content for each question
//         if (enContent && arContent) {
//             enContent.style.display = currentLang === 'en' ? 'block' : 'none';
//             arContent.style.display = currentLang === 'en' ? 'none' : 'block';
//         }
//     });
    
//     // Update the toggle button text
//     document.querySelector('.lang-toggle').innerText = currentLang === 'en' ? 'العربية' : 'English';
// }

function toggleLanguage() {
    currentLang = currentLang === 'en' ? 'ar' : 'en';
    
    // Update the hidden language input field
    document.getElementById('selectedLang').value = currentLang;
    
    // Loop through all question containers
    questions.forEach(question => {
        const enContent = question.querySelector('.en-content');
        const arContent = question.querySelector('.ar-content');
        
        // Toggle visibility of language-specific content for each question
        if (enContent && arContent) {
            enContent.style.display = currentLang === 'en' ? 'block' : 'none';
            arContent.style.display = currentLang === 'en' ? 'none' : 'block';
        }
    });

    // Toggle language for the heading and introductory paragraph
    document.querySelectorAll('[data-en]').forEach(element => {
        element.textContent = element.getAttribute(`data-${currentLang}`);
    });
    
    // Update the toggle button text
    document.querySelector('.lang-toggle').innerText = currentLang === 'en' ? 'العربية' : 'English';
}


  // // Initialize to ensure English is shown by default
  // document.addEventListener('DOMContentLoaded', function() {
  //     // Set the initial language to English
  //     currentLang = 'en';
      
  //     // Ensure the correct language content is displayed on load
  //     questions.forEach(question => {
  //         const enContent = question.querySelector('.en-content');
  //         const arContent = question.querySelector('.ar-content');
          
  //         if (enContent && arContent) {
  //             enContent.style.display = 'block';  // Show English content
  //             arContent.style.display = 'none';   // Hide Arabic content
  //         }
  //     });
  
  //     // Set the language toggle button text
  //     document.querySelector('.lang-toggle').innerText = 'العربية';
  
  //     // Initially show the first question and add event listeners
  //     showQuestion(0);
  //     addRadioEventListeners();
  // });
  

  document.addEventListener('DOMContentLoaded', function() {
    // Initialize currentLang from the hidden input value
    currentLang = document.getElementById('selectedLang').value || 'en';
    
    // Ensure the correct language content is displayed on load
    questions.forEach(question => {
        const enContent = question.querySelector('.en-content');
        const arContent = question.querySelector('.ar-content');
        
        if (enContent && arContent) {
            enContent.style.display = currentLang === 'en' ? 'block' : 'none';
            arContent.style.display = currentLang === 'en' ? 'none' : 'block';
        }
    });

    // Set the language toggle button text
    document.querySelector('.lang-toggle').innerText = currentLang === 'en' ? 'العربية' : 'English';

    // Initially show the first question and add event listeners
    showQuestion(0);
    addRadioEventListeners();
});


  </script>
</body>
</html>
